#!/usr/bin/env node
var logger = require('loge');
var commands = require('./commands');

var yargs = require('yargs')
  .usage('Usage: $0 -f ScienceArticle.pdf [-o 1:0]')
  .describe({
    filename: 'pdf file to open',
    // dump targets
    trailer: 'dump trailer',
    catalog: 'dump trailer Root',
    info: 'dump trailer Info',
    xref: 'dump cross references',
    object: 'object(s) to dump',
    stream: 'stream(s) to dump',
    pages: 'dump pages',
    // cli meta
    help: 'print this help message',
    verbose: 'print extra output',
  })
  .alias({
    verbose: 'v',
    filename: 'f',
    object: 'o',
    stream: 's',
  })
  .demand(['filename'])
  .boolean(['help', 'verbose', 'trailer', 'xref', 'pages']);

var argv = yargs.argv;
logger.level = argv.verbose ? 'debug' : 'info';

if (argv.help) {
  yargs.showHelp();
}
else if (argv.version) {
  console.log(require('../package').version);
}
else {
  commands.dump(argv.filename, argv.trailer, argv.catalog, argv.info, argv.xref, argv.pages,
    [].concat(argv.object), [].concat(argv.stream));
}
